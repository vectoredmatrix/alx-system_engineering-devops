#!/bin/bash
WATER_BASE="water"
STIR_BASE="stir"
TARGET_BASE="bestchol"

to_decimal() {
    local num=$1 base=$2 dec=0 i val
    for ((i=0;i<${#num};i++)); do
        val=$(expr index "$base" "${num:i:1}")  # 1-based
        ((val--))
        dec=$(echo "$dec * ${#base} + $val" | bc)
    done
    echo "$dec"
}

from_decimal() {
    local num=$1 base=$2 out="" b=${#base} mod
    if [ "$num" -eq 0 ]; then
        echo "${base:0:1}"
        return
    fi
    while [ "$num" -gt 0 ]; do
        mod=$(echo "$num % $b" | bc)
        out="${base:mod:1}$out"
        num=$(echo "$num / $b" | bc)
    done
    echo "$out"
}

sum=$(echo "$(to_decimal "$WATER" "$WATER_BASE") + $(to_decimal "$STIR" "$STIR_BASE")" | bc)
from_decimal "$sum" "$TARGET_BASE"
