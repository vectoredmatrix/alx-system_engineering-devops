#!/bin/bash
# Custom base alphabets as required by ALX
WATER_BASE="water"
STIR_BASE="stir"
TARGET_BASE="bestchol"

# Convert a string in a custom base to decimal
to_decimal() {
    local num=$1 base=$2 dec=0 i val
    for ((i=0;i<${#num};i++)); do
        val=$(expr index "$base" "${num:i:1}")   # 1-based
        dec=$(( dec * ${#base} + val - 1 ))      # convert to 0-based
    done
    echo "$dec"
}

# Convert decimal number to string in a custom base
from_decimal() {
    local num=$1 base=$2 out=""
    if (( num == 0 )); then
        echo "${base:0:1}"
        return
    fi
    while (( num > 0 )); do
        out="${base:num % ${#base}:1}$out"
        (( num /= ${#base} ))
    done
    echo "$out"
}

# Add WATER and STIR (from environment), output in TARGET_BASE
sum=$(( $(to_decimal "$WATER" "$WATER_BASE") + $(to_decimal "$STIR" "$STIR_BASE") ))
from_decimal "$sum" "$TARGET_BASE"
